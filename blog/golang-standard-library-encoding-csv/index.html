<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossOrigin="anonymous"/><style data-href="/app.654f3adca362e508263b.css">.fqxoyvp{display:var(--fqxoyvp-0);flex-direction:var(--fqxoyvp-1);justify-content:var(--fqxoyvp-2);align-content:var(--fqxoyvp-3);align-items:var(--fqxoyvp-4);width:var(--fqxoyvp-5);max-width:var(--fqxoyvp-5);padding:var(--fqxoyvp-7);flex-wrap:var(--fqxoyvp-8);box-sizing:border-box}.a1oo7sao{cursor:pointer;padding:4px 10px;display:inline-block;background:var(--a1oo7sao-1);color:var(--a1oo7sao-2)}.a1oo7sao,.i18iqvvt{border:1px solid #182b1a;border-radius:4px;margin:6px}.i18iqvvt{background:#fff;padding:10px 12px;font-size:1em}.i18iqvvt:focus{outline:none}.snfdkht.i18iqvvt{cursor:pointer;background:#519657;color:#fff}.snfdkht.i18iqvvt:hover{color:#38693c}.md69m4h{z-index:9;position:fixed;left:0;top:0;width:100%;height:100%;overflow:auto;background:rgba(0,0,0,.4);display:flex;justify-content:center;align-items:center}.m1qhrv2h{z-index:10;width:500px;max-width:90%;min-height:50%;max-height:90%;background:#f5f4e9;border-radius:6px;padding:16px 0}.c1cih5b{flex:1 1}.fszldm{justify-self:flex-end}.m15xpxwi{color:#2b1d0e;-webkit-letter-spacing:2px;-moz-letter-spacing:2px;-ms-letter-spacing:2px;letter-spacing:2px;margin:0}@media screen and (max-width:40em){.m15xpxwi{font-size:20px}}@media screen and (max-width:20em){.m15xpxwi{font-size:18px}}.h5wsek6{height:4rem;position:fixed;top:0;background:#f5f4e9;z-index:1;box-shadow:0 1px 3px rgba(0,0,0,.05);padding:16px 0;-webkit-text-decoration:none;text-decoration:none;width:100%}.i4awmdj{cursor:pointer;color:#2b1d0e;font-size:1.5rem;margin-right:10px}.fpnldgf{height:4rem;box-shadow:0 -1px 3px rgba(0,0,0,.05)}.tw06ds8{text-align:center}@font-face{font-family:Lato;font-style:normal;font-weight:400;src:local("Lato Regular"),local("Lato-Regular"),url(/static/Lato-129179c4eeb1d784d3d3ad95e0b35905.woff2),url(https://fonts.gstatic.com/s/lato/v15/S6uyw4BMUTPHjx4wXiWtFCc.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-family:Cormorant Garamond;font-style:normal;font-weight:400;src:local("Cormorant Garamond Regular"),local("CormorantGaramond-Regular"),url(/static/CormorantGaramond-5733ac592c848166a661326d6d7dd685.woff2),url(https://fonts.gstatic.com/s/cormorantgaramond/v6/co3bmX5slCNuHLi8bLeY9MK7whWMhyjYqXtKky2F7g.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}body{margin:0;padding:0;font-family:Lato;background:#f5f4e9;color:#2b1d0e;font-size:18px}h1,h2,h3,h4,h5,h6{font-family:Cormorant Garamond}h1,h2{margin-top:4rem}h2{font-weight:600}h3{margin-top:3rem}h4{margin-top:2rem}p{line-height:1.8}a{color:#519657}a,a:link,a:visited{text-decoration:none}a:active,a:hover{color:#38693c}pre{overflow:scroll;border-radius:4px;padding:10px 20px;font-size:.8rem}pre,pre code{background:#444;color:#63e463}pre code{border:none;padding:0;border-radius:0;margin:0}code{color:#3eab3e;background:rgba(99,228,99,.1);border-radius:4px;padding:2px 4px;margin:0 4px;font-size:.9rem}blockquote{border-left:6px solid rgba(179,195,180,.5);padding-left:32px;margin:32px 0}li{margin-bottom:8px}.m18vmv4p{padding:6rem 0 2rem}.m1p35dyn{max-width:95%;width:800px}</style><meta name="generator" content="Gatsby 2.0.31"/><title data-react-helmet="true">Blog | Go&#x27;s Standard Library By Example: encoding/csv</title><link as="script" rel="preload" href="/webpack-runtime-240a6a08c307e98a4927.js"/><link as="script" rel="preload" href="/app-65ddc085a1e9fca3c501.js"/><link as="script" rel="preload" href="/0-43b751d6e4b3f1db19a5.js"/><link as="script" rel="preload" href="/1-3919a7c707d0d50ea252.js"/><link as="script" rel="preload" href="/component---src-templates-article-tsx-b562facbfa4e4e9b45e1.js"/><link rel="preload" href="/static/d/557/path---blog-golang-standard-library-encoding-csv-08-b-b1f-nmTDpML4zL1oqWzYXlnq3DV9U.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div direction="column" class="fqxoyvp" style="--fqxoyvp-0:flex;--fqxoyvp-1:column;--fqxoyvp-2:flex-start;--fqxoyvp-3:stretch;--fqxoyvp-4:stretch;--fqxoyvp-5:100%;--fqxoyvp-7:0px;--fqxoyvp-8:nowrap"><div class="h5wsek6 fqxoyvp" style="--fqxoyvp-0:flex;--fqxoyvp-1:row;--fqxoyvp-2:flex-start;--fqxoyvp-3:stretch;--fqxoyvp-4:stretch;--fqxoyvp-5:100%;--fqxoyvp-7:0px 16px;--fqxoyvp-8:nowrap"><div class="fqxoyvp" style="--fqxoyvp-0:flex;--fqxoyvp-1:row;--fqxoyvp-2:flex-start;--fqxoyvp-3:stretch;--fqxoyvp-4:center;--fqxoyvp-5:50%;--fqxoyvp-7:0px 16px;--fqxoyvp-8:nowrap"><div style="display:flex;align-items:center"><a href="/"><h2 class="m15xpxwi">Keith Alpichi</h2></a></div></div><div class="fqxoyvp" style="--fqxoyvp-0:flex;--fqxoyvp-1:row;--fqxoyvp-2:flex-end;--fqxoyvp-3:stretch;--fqxoyvp-4:stretch;--fqxoyvp-5:50%;--fqxoyvp-7:0px 16px;--fqxoyvp-8:nowrap"><a href="https://www.linkedin.com/in/keithalpichi" class="i4awmdj"><i class="fab fa-linkedin"></i></a><a href="https://github.com/keithalpichi" class="i4awmdj"><i class="fab fa-github-square"></i></a><a href="https://twitter.com/keithalpichi" class="i4awmdj"><i class="fab fa-twitter-square"></i></a><a class="i4awmdj" href="/about"><i class="fas fa-info-circle"></i></a></div></div><div class="m18vmv4p fqxoyvp" direction="column" style="--fqxoyvp-0:flex;--fqxoyvp-1:column;--fqxoyvp-2:flex-start;--fqxoyvp-3:stretch;--fqxoyvp-4:center;--fqxoyvp-5:100%;--fqxoyvp-7:0px 16px;--fqxoyvp-8:nowrap"><div class="m1p35dyn fqxoyvp" style="--fqxoyvp-0:inline;--fqxoyvp-1:row;--fqxoyvp-2:flex-start;--fqxoyvp-3:stretch;--fqxoyvp-4:stretch;--fqxoyvp-5:100%;--fqxoyvp-7:0px 16px;--fqxoyvp-8:wrap"><h1 style="line-height:1">Go&#x27;s Standard Library By Example: encoding/csv</h1><h3 style="color:#b3c3b4;margin-top:0">Monday, May 21st 2018</h3><div direction="row" class="fqxoyvp" style="--fqxoyvp-0:flex;--fqxoyvp-1:row;--fqxoyvp-2:flex-start;--fqxoyvp-3:stretch;--fqxoyvp-4:stretch;--fqxoyvp-5:100%;--fqxoyvp-7:0px;--fqxoyvp-8:wrap"><a color="success" class="a1oo7sao" style="--a1oo7sao-1:#519657;--a1oo7sao-2:#FFFFFF">golang</a></div><div style="margin-top:64px"><p>Reading from and writing to CSV files is extremely simple with Go's encoding/csv package. Today, I'm going to discuss just how simple it is.</p>
<h2>Introduction</h2>
<p>The standard library is very robust. Consider standard library packages over bulky third-party frameworks. Essentially, a lot of your needs as a Go engineer can be fulfilled with the standard library. So it's important to understand and use the built-in packages Go has to offer.</p>
<p>This is one article in my Go's Standard Library By Example article series that provides simplified explanations and practical examples of Go's standard library.</p>
<h3>Level of Difficulty: Beginner</h3>
<h3>Prerequisites: Basic understanding of "io" and "os" packages</h3>
<h2>Reading From CSVs</h2>
<p>To read from a CSV file it must be opened with os.Open. This will return a pointer to the file descriptor, os.File. Now since the file implements the io.Reader interface it can be given to the csv.NewReader to make a csv.Reader.</p>
<p>Let's say we have this CSV file named "foo.csv":</p>
<pre><code>| ID  | Name | Email            | Revenue  |
|-----|------|------------------|----------|
| 123 | John | john@example.com | $141,987 |
|-----|------|------------------|----------|
| 456 | Sam  | sam@example.com  | $905,234 |
</code></pre>
<p>We then can open it and create a <code>csv.Reader</code>.</p>
<pre><code>csvFile, err := os.Open("./foo.csv")
if err != nil {
  panic(err)
}
defer csvFile.Close()

csvReader := csv.NewReader(csvFile)
</code></pre>
<p>Let me take a second to highlight the beauty of interfaces. Since <code>csv.NewReader</code> accepts the <code>io.Reader</code> interface you can provide it with any source besides CSV files as long as it fulfills the interface. It doesn't have to be a file. You can also use:</p>
<ul>
<li><code>strings.NewReader</code> to create a reader from a string</li>
<li><code>bytes.NewReader</code> to create a reader from a byte slice</li>
<li><code>bufio.NewReader</code> to create a buffered reader from an existing reader</li>
</ul>
<blockquote>
<p>Pro Tip: testing and debugging with these are extremely useful</p>
</blockquote>
<h2>Reading a Single Row</h2>
<p>You're now ready to read a single row with <code>csv.Reader.Read</code>.</p>
<pre><code>row, err := csvReader.Read()
</code></pre>
<p>It returns a string slice and an error. If you've hit the end of the file the error will be <code>io.EOF</code>.</p>
<p>This should go without saying but each string in the slice are in the same order as the CSV. By knowing the order of the cells in the CSV header you can index the corresponding cell in another row. For example, since the first row of this file is the header, the slice would be <code>[]string{"ID", "Name", "Email", "Revenue"}</code>. So,</p>
<pre><code>n := row[1] // n == "Name"
</code></pre>
<p><code>n</code> equals "Name". All subsequent rows will contain the same order. Cool! We have read the header row successfully. From here we can keep reading each row one at a time. If you want to read every row, a practical way is to use a for-loop and handle each error like this:</p>
<pre><code>for {
  row, err := csvReader.Read()
  if err == io.EOF {
    break
  } else if err != nil {
    panic(err) // or handle it another way
  }
  // use the `row` here
}
</code></pre>
<p>We continuously read each row, break if we hit the end, panic if we hit another error, or use the data in the row if no error exists.</p>
<h2>Reading the Remaining Rows</h2>
<p>You can also read the remaining rows from the <code>csv.Reader</code> with <code>csv.ReadAll</code>. It returns a slice of string slices and an error. When it reaches the end of the file it does not return an error.</p>
<pre><code>rows, err := csvReader.ReadAll() // `rows` is of type [][]string
if err != nil {
  panic(err)
}
for i, row := range rows {
  // process the `row` here
}
</code></pre>
<h2>Writing To CSVs</h2>
<p>To write to a CSV file, the file must first be created with <code>os.Create</code>. If the file exists already it will be overwritten. Just like <code>os.Open</code>, this will also return a pointer to the file descriptor, <code>os.File</code>. The file, again, implements the <code>io.Writer</code> interface; thus it can be given to the <code>csv.NewWriter</code> to make a <code>csv.Writer</code>.</p>
<pre><code>csvFile, err := os.Create("./bar.csv")
if err != nil {
  panic(err)
}
defer csvFile.Close()

csvWriter := csv.NewWriter(csvFile)
</code></pre>
<h2>Writing a Single Row</h2>
<p>Now we're ready to write to the file with <code>csv.Writer.Write</code>. This function takes a slice of strings.</p>
<pre><code>err := csvWriter.Write([]string{"678", "Jane", "jane@example.com", "$548,980"})
</code></pre>
<p>Surprisingly, this does not write to the file. It only writes to a buffer. When you're finished writing to the buffer and want to write to the file you must call <code>csv.Writer.Flush</code>. You can think of this "flushing" the buffered data to the underlying writer.</p>
<pre><code>csvWriter.Flush()
err := csvWriter.Error()
if err != nil {
  // an error occurred during the flush
}
</code></pre>
<h2>Writing Many Rows</h2>
<p>To write many rows and flush at once you can use <code>csv.Writer.WriteAll</code>.</p>
<pre><code>rows := [][]string{
  { "123", "John", "john@example.com", "$141,987"},
  { "456", "Sam", "sam@example.com", "$905,234"},
  { "678", "Jane", "jane@example.com", "$548,980"},
}
err := csvWriter.WriteAll(rows)
</code></pre>
<h2>Conclusion</h2>
<p>This package has to be the most simplest package to learn and use. It's main focus is reading from and writing to CSV files. You simply create readers and writers and call a few functions. What you do with with the CSV data after reading and before writing is what other standard library packages are useful for. You can:</p>
<ul>
<li>convert cells, which when read are a string type, to basic data types with the "strconv" package. You'll also convert these types back to strings with this package when you want to write a row</li>
<li>use the "strings" package to perform string manipulations like trimming spaces and splitting on comma delimiters</li>
<li>use concurrency primitives such as channels and goroutines to process each row concurrently instead of sequentially</li>
<li>use the "math" package to perform math calculations</li>
</ul></div><p>Thank you for reading my article. Make sure to check out some related articles by following one of the tags below.</p><div direction="row" class="fqxoyvp" style="--fqxoyvp-0:flex;--fqxoyvp-1:row;--fqxoyvp-2:flex-start;--fqxoyvp-3:stretch;--fqxoyvp-4:stretch;--fqxoyvp-5:100%;--fqxoyvp-7:0px;--fqxoyvp-8:wrap"><a color="success" class="a1oo7sao" style="--a1oo7sao-1:#519657;--a1oo7sao-2:#FFFFFF">all tags</a><a color="success" class="a1oo7sao" style="--a1oo7sao-1:#519657;--a1oo7sao-2:#FFFFFF">golang</a></div></div></div><div class="fpnldgf fqxoyvp" style="--fqxoyvp-0:inline;--fqxoyvp-1:row;--fqxoyvp-2:flex-start;--fqxoyvp-3:stretch;--fqxoyvp-4:stretch;--fqxoyvp-5:100%;--fqxoyvp-7:0px 16px;--fqxoyvp-8:wrap"><p class="tw06ds8">Aloha, World 🤙</p></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-article-tsx","jsonName":"blog-golang-standard-library-encoding-csv-08b","path":"/blog/golang-standard-library-encoding-csv"};window.dataPath="557/path---blog-golang-standard-library-encoding-csv-08-b-b1f-nmTDpML4zL1oqWzYXlnq3DV9U";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app.654f3adca362e508263b.css","/app-65ddc085a1e9fca3c501.js"],"component---src-templates-article-tsx":["/component---src-templates-article-tsx-b562facbfa4e4e9b45e1.js"],"component---src-templates-tags-tsx":["/component---src-templates-tags-tsx-560cd5e188a2c4ca4464.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx.4abde67b4aa83d42a197.css","/component---src-pages-404-tsx-7f2afd0801d6c35c973d.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-2766eef2bf52db10b8d0.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx.0d82ef3b9f5d3fc298aa.css","/component---src-pages-index-tsx-bbbc9fbb418fe3261273.js"],"component---src-pages-tags-tsx":["/component---src-pages-tags-tsx-9a553f1170f6aa152689.js"]};/*]]>*/</script><script src="/component---src-templates-article-tsx-b562facbfa4e4e9b45e1.js" async=""></script><script src="/1-3919a7c707d0d50ea252.js" async=""></script><script src="/0-43b751d6e4b3f1db19a5.js" async=""></script><script src="/app-65ddc085a1e9fca3c501.js" async=""></script><script src="/webpack-runtime-240a6a08c307e98a4927.js" async=""></script></body></html>