<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous"/><link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&amp;family=Roboto:ital,wght@0,300;0,400;0,700;0,900;1,500&amp;display=swap" rel="stylesheet"/><style data-href="/styles.dd504296c4fc23c7e4ca.css">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}b,strong{font-weight:bolder}code{font-family:monospace,monospace;font-size:1em}small{font-size:80%}button{font-family:inherit;font-size:100%;line-height:1.15;margin:0;overflow:visible;text-transform:none;-webkit-appearance:button}button::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring{outline:1px dotted ButtonText}[hidden]{display:none}h1,h2,h3,p,pre{margin:0}button{background-color:transparent;background-image:none}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}ul{margin:0;padding:0;list-style:none}html{font-family:Roboto,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}*{box-sizing:border-box;border:0 solid #e2e8f0}[role=button],button{cursor:pointer}h1,h2,h3{font-size:inherit;font-weight:inherit}a{text-decoration:inherit}a,button{color:inherit}button{padding:0;line-height:inherit}code,pre{font-family:Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}svg{display:block;vertical-align:middle}h1{line-height:1;font-size:2.25rem;--text-opacity:1;color:#f7c257;color:rgba(247,194,87,var(--text-opacity));font-family:Bebas Neue,Roboto,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;margin-top:3rem;margin-bottom:2rem}h2{font-size:1.875rem;margin-top:2rem}h2,h3{line-height:1;--text-opacity:1;color:#19445c;color:rgba(25,68,92,var(--text-opacity));font-family:Bebas Neue,Roboto,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;margin-bottom:1rem}h3{font-size:1.25rem;margin-top:1.5rem}@media (min-width:1024px){h1{font-size:4rem}h2{font-size:2.25rem}h3{font-size:1.5rem}}p{margin-top:1rem;margin-bottom:1rem;--text-opacity:1;color:#123346;color:rgba(18,51,70,var(--text-opacity))}li{margin-left:2rem;list-style-type:circle}code{padding:0 .25rem;margin:0}code,pre{white-space:pre-wrap;overflow:scroll;background:#19445c;color:#fff;border-radius:.125rem}pre{padding:.5rem;margin:2rem 0}.text-active{color:#88c4c8}.main{display:flex;flex-direction:column;margin:3rem auto auto;max-width:95%;width:75rem}#aloha{margin:16rem auto auto;max-width:90%;width:40rem}.wave{animation:wave 7s cubic-bezier(.36,.45,.63,.53) infinite;transform:translateZ(0)}.tags{display:flex;flex-direction:row;flex-wrap:wrap;margin-top:2.5rem;margin-bottom:2.5rem}.bg-transparent{background-color:transparent}.bg-cream{--bg-opacity:1;background-color:#fdf7ec;background-color:rgba(253,247,236,var(--bg-opacity))}.bg-burnt{--bg-opacity:1;background-color:#dc885d;background-color:rgba(220,136,93,var(--bg-opacity))}.bg-primary{--bg-opacity:1;background-color:#88c4c8;background-color:rgba(136,196,200,var(--bg-opacity))}.bg-secondary{--bg-opacity:1;background-color:#19445c;background-color:rgba(25,68,92,var(--bg-opacity))}.bg-success{--bg-opacity:1;background-color:#9ca97d;background-color:rgba(156,169,125,var(--bg-opacity))}.bg-danger{--bg-opacity:1;background-color:#dc885d;background-color:rgba(220,136,93,var(--bg-opacity))}.bg-info{--bg-opacity:1;background-color:#f7c257;background-color:rgba(247,194,87,var(--bg-opacity))}.hover\:border-white:hover{--border-opacity:1;border-color:#fff;border-color:rgba(255,255,255,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-md{border-radius:.375rem}.rounded-full{border-radius:9999px}.border{border-width:1px}.cursor-pointer{cursor:pointer}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.hidden{display:none}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.flex-grow{flex-grow:1}.flex-shrink-0{flex-shrink:0}.font-semibold{font-weight:600}.h-3{height:.75rem}.h-4{height:1rem}.text-sm{font-size:.875rem}.leading-5{line-height:1.25rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mt-0{margin-top:0}.mb-0{margin-bottom:0}.mr-4{margin-right:1rem}.mr-6{margin-right:1.5rem}.mb-12{margin-bottom:3rem}.mt-32{margin-top:8rem}.p-0{padding:0}.p-4{padding:1rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-2{padding-left:.5rem;padding-right:.5rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.fixed{position:fixed}.top-0{top:0}.right-0{right:0}.left-0{left:0}.fill-current{fill:currentColor}.text-center{text-align:center}.text-white{--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity))}.text-navy{--text-opacity:1;color:#19445c;color:rgba(25,68,92,var(--text-opacity))}.text-ocean{--text-opacity:1;color:#246183;color:rgba(36,97,131,var(--text-opacity))}.text-primary{--text-opacity:1;color:#88c4c8;color:rgba(136,196,200,var(--text-opacity))}.hover\:text-white:hover{--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity))}.w-3{width:.75rem}.w-4{width:1rem}.w-full{width:100%}.gap-x-0{grid-column-gap:0;column-gap:0}.gap-y-16{grid-row-gap:4rem;row-gap:4rem}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.col-span-2{grid-column:span 2/span 2}@keyframes spin{to{transform:rotate(1turn)}}@keyframes ping{75%,to{transform:scale(2);opacity:0}}@keyframes pulse{50%{opacity:.5}}@keyframes bounce{0%,to{transform:translateY(-25%);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;animation-timing-function:cubic-bezier(0,0,.2,1)}}@keyframes wave{0%{margin-left:0}to{margin-left:-1600px}}@media (min-width:1024px){.lg\:bg-transparent{background-color:transparent}.lg\:block{display:block}.lg\:inline-block{display:inline-block}.lg\:flex{display:flex}.lg\:hidden{display:none}.lg\:flex-row{flex-direction:row}.lg\:items-center{align-items:center}.lg\:justify-end{justify-content:flex-end}.lg\:flex-grow{flex-grow:1}.lg\:h-8{height:2rem}.lg\:mt-0{margin-top:0}.lg\:py-0{padding-top:0;padding-bottom:0}.lg\:w-8{width:2rem}.lg\:w-auto{width:auto}.lg\:gap-x-12{grid-column-gap:3rem;column-gap:3rem}.lg\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.lg\:col-span-1{grid-column:span 1/span 1}}</style><meta name="generator" content="Gatsby 2.24.85"/><title data-react-helmet="true">Blog | Go&#x27;s Standard Library By Example: encoding/csv</title><link rel="icon" href="/favicon.svg?v=3e33d61cff0300426a5d0e1552cad9af" type="image/svg+xml"/><link rel="icon" href="/favicon-32x32.png?v=3e33d61cff0300426a5d0e1552cad9af" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=3e33d61cff0300426a5d0e1552cad9af"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=3e33d61cff0300426a5d0e1552cad9af"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=3e33d61cff0300426a5d0e1552cad9af"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=3e33d61cff0300426a5d0e1552cad9af"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=3e33d61cff0300426a5d0e1552cad9af"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=3e33d61cff0300426a5d0e1552cad9af"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=3e33d61cff0300426a5d0e1552cad9af"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=3e33d61cff0300426a5d0e1552cad9af"/><link as="script" rel="preload" href="/webpack-runtime-69e5925a9d24cfbe15ca.js"/><link as="script" rel="preload" href="/styles-55e82d6ff5158c00b714.js"/><link as="script" rel="preload" href="/framework-cc03bb45506d81428ff3.js"/><link as="script" rel="preload" href="/app-ce9eeb1bfb423021ce62.js"/><link as="script" rel="preload" href="/4c33c8297f77762f6e9a22ebb7ccee192c57b0cf-7398846d9f983a3f4b59.js"/><link as="script" rel="preload" href="/ec00cb3cf49bfda73da655732e2bb5ae6d56dc86-ca32cd7e761d94a44583.js"/><link as="script" rel="preload" href="/component---src-templates-article-tsx-1944929b342adaf0355c.js"/><link as="fetch" rel="preload" href="/page-data/blog/golang-standard-library-encoding-csv/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body class="bg-cream"><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><nav class="fixed top-0 left-0 right-0 flex bg-burnt lg:bg-transparent items-center justify-between flex-wrap p-4"><div class="flex items-center flex-shrink-0 text-navy mr-6"><svg class="cursor-pointer fill-current text-navy" width="25" height="25" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.6667 0H0L8.33333 16.6667L16.6667 0Z"></path><path d="M33.3333 0H16.6666L25 16.6667L33.3333 0Z"></path><path d="M50 0H33.3334L41.6667 16.6667L50 0Z"></path><path d="M16.6667 16.6667H0L8.33333 33.3333L16.6667 16.6667Z"></path><path d="M33.3333 16.6667H16.6666L25 33.3333L33.3333 16.6667Z"></path><path d="M50 16.6667H33.3334L41.6667 33.3333L50 16.6667Z"></path><path d="M16.6667 33.3333H0L8.33333 50L16.6667 33.3333Z"></path><path d="M33.3333 33.3333H16.6666L25 50L33.3333 33.3333Z"></path><path d="M50 33.3333H33.3334L41.6667 50L50 33.3333Z"></path></svg></div></nav><div class="main"><h1 class="mb-0">Go&#x27;s Standard Library By Example: encoding/csv</h1><p>Monday, May 21st, 2018</p><div class="tags"><span class="bg-transparent text-primary cursor-pointer px-2 inline-flex text-sm leading-5 font-semibold rounded-full">golang</span></div><div><p>Reading from and writing to CSV files is extremely simple with Go's encoding/csv package. Today, I'm going to discuss just how simple it is.</p>
<h2>Introduction</h2>
<p>The standard library is very robust. Consider standard library packages over bulky third-party frameworks. Essentially, a lot of your needs as a Go engineer can be fulfilled with the standard library. So it's important to understand and use the built-in packages Go has to offer.</p>
<p>This is one article in my Go's Standard Library By Example article series that provides simplified explanations and practical examples of Go's standard library.</p>
<h3>Level of Difficulty: Beginner</h3>
<h3>Prerequisites: Basic understanding of "io" and "os" packages</h3>
<h2>Reading From CSVs</h2>
<p>To read from a CSV file it must be opened with os.Open. This will return a pointer to the file descriptor, os.File. Now since the file implements the io.Reader interface it can be given to the csv.NewReader to make a csv.Reader.</p>
<p>Let's say we have this CSV file named "foo.csv":</p>
<pre><code>| ID  | Name | Email            | Revenue  |
|-----|------|------------------|----------|
| 123 | John | john@example.com | $141,987 |
|-----|------|------------------|----------|
| 456 | Sam  | sam@example.com  | $905,234 |
</code></pre>
<p>We then can open it and create a <code>csv.Reader</code>.</p>
<pre><code>csvFile, err := os.Open("./foo.csv")
if err != nil {
  panic(err)
}
defer csvFile.Close()

csvReader := csv.NewReader(csvFile)
</code></pre>
<p>Let me take a second to highlight the beauty of interfaces. Since <code>csv.NewReader</code> accepts the <code>io.Reader</code> interface you can provide it with any source besides CSV files as long as it fulfills the interface. It doesn't have to be a file. You can also use:</p>
<ul>
<li><code>strings.NewReader</code> to create a reader from a string</li>
<li><code>bytes.NewReader</code> to create a reader from a byte slice</li>
<li><code>bufio.NewReader</code> to create a buffered reader from an existing reader</li>
</ul>
<blockquote>
<p>Pro Tip: testing and debugging with these are extremely useful</p>
</blockquote>
<h2>Reading a Single Row</h2>
<p>You're now ready to read a single row with <code>csv.Reader.Read</code>.</p>
<pre><code>row, err := csvReader.Read()
</code></pre>
<p>It returns a string slice and an error. If you've hit the end of the file the error will be <code>io.EOF</code>.</p>
<p>This should go without saying but each string in the slice are in the same order as the CSV. By knowing the order of the cells in the CSV header you can index the corresponding cell in another row. For example, since the first row of this file is the header, the slice would be <code>[]string{"ID", "Name", "Email", "Revenue"}</code>. So,</p>
<pre><code>n := row[1] // n == "Name"
</code></pre>
<p><code>n</code> equals "Name". All subsequent rows will contain the same order. Cool! We have read the header row successfully. From here we can keep reading each row one at a time. If you want to read every row, a practical way is to use a for-loop and handle each error like this:</p>
<pre><code>for {
  row, err := csvReader.Read()
  if err == io.EOF {
    break
  } else if err != nil {
    panic(err) // or handle it another way
  }
  // use the `row` here
}
</code></pre>
<p>We continuously read each row, break if we hit the end, panic if we hit another error, or use the data in the row if no error exists.</p>
<h2>Reading the Remaining Rows</h2>
<p>You can also read the remaining rows from the <code>csv.Reader</code> with <code>csv.ReadAll</code>. It returns a slice of string slices and an error. When it reaches the end of the file it does not return an error.</p>
<pre><code>rows, err := csvReader.ReadAll() // `rows` is of type [][]string
if err != nil {
  panic(err)
}
for i, row := range rows {
  // process the `row` here
}
</code></pre>
<h2>Writing To CSVs</h2>
<p>To write to a CSV file, the file must first be created with <code>os.Create</code>. If the file exists already it will be overwritten. Just like <code>os.Open</code>, this will also return a pointer to the file descriptor, <code>os.File</code>. The file, again, implements the <code>io.Writer</code> interface; thus it can be given to the <code>csv.NewWriter</code> to make a <code>csv.Writer</code>.</p>
<pre><code>csvFile, err := os.Create("./bar.csv")
if err != nil {
  panic(err)
}
defer csvFile.Close()

csvWriter := csv.NewWriter(csvFile)
</code></pre>
<h2>Writing a Single Row</h2>
<p>Now we're ready to write to the file with <code>csv.Writer.Write</code>. This function takes a slice of strings.</p>
<pre><code>err := csvWriter.Write([]string{"678", "Jane", "jane@example.com", "$548,980"})
</code></pre>
<p>Surprisingly, this does not write to the file. It only writes to a buffer. When you're finished writing to the buffer and want to write to the file you must call <code>csv.Writer.Flush</code>. You can think of this "flushing" the buffered data to the underlying writer.</p>
<pre><code>csvWriter.Flush()
err := csvWriter.Error()
if err != nil {
  // an error occurred during the flush
}
</code></pre>
<h2>Writing Many Rows</h2>
<p>To write many rows and flush at once you can use <code>csv.Writer.WriteAll</code>.</p>
<pre><code>rows := [][]string{
  { "123", "John", "john@example.com", "$141,987"},
  { "456", "Sam", "sam@example.com", "$905,234"},
  { "678", "Jane", "jane@example.com", "$548,980"},
}
err := csvWriter.WriteAll(rows)
</code></pre>
<h2>Conclusion</h2>
<p>This package has to be the most simplest package to learn and use. It's main focus is reading from and writing to CSV files. You simply create readers and writers and call a few functions. What you do with with the CSV data after reading and before writing is what other standard library packages are useful for. You can:</p>
<ul>
<li>convert cells, which when read are a string type, to basic data types with the "strconv" package. You'll also convert these types back to strings with this package when you want to write a row</li>
<li>use the "strings" package to perform string manipulations like trimming spaces and splitting on comma delimiters</li>
<li>use concurrency primitives such as channels and goroutines to process each row concurrently instead of sequentially</li>
<li>use the "math" package to perform math calculations</li>
</ul></div><p>Thank you for reading my article. Make sure to check out some related articles by following one of the tags below.</p><div class="tags"><span class="bg-transparent text-primary cursor-pointer px-2 inline-flex text-sm leading-5 font-semibold rounded-full">all tags</span><span class="bg-transparent text-primary cursor-pointer px-2 inline-flex text-sm leading-5 font-semibold rounded-full">golang</span></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/golang-standard-library-encoding-csv";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-01365ee183870cafc13e.js"],"app":["/app-ce9eeb1bfb423021ce62.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-dc5900e3d8b1e4d3a841.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-01dc39b3bd98a3d29aa9.js"],"component---src-pages-tags-tsx":["/component---src-pages-tags-tsx-28f771f71cd974290932.js"],"component---src-templates-article-tsx":["/component---src-templates-article-tsx-1944929b342adaf0355c.js"],"component---src-templates-tags-tsx":["/component---src-templates-tags-tsx-fbc198730734c9e2a370.js"]};/*]]>*/</script><script src="/polyfill-01365ee183870cafc13e.js" nomodule=""></script><script src="/component---src-templates-article-tsx-1944929b342adaf0355c.js" async=""></script><script src="/ec00cb3cf49bfda73da655732e2bb5ae6d56dc86-ca32cd7e761d94a44583.js" async=""></script><script src="/4c33c8297f77762f6e9a22ebb7ccee192c57b0cf-7398846d9f983a3f4b59.js" async=""></script><script src="/app-ce9eeb1bfb423021ce62.js" async=""></script><script src="/framework-cc03bb45506d81428ff3.js" async=""></script><script src="/styles-55e82d6ff5158c00b714.js" async=""></script><script src="/webpack-runtime-69e5925a9d24cfbe15ca.js" async=""></script></body></html>